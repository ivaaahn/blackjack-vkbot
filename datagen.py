import json
from datetime import datetime, timedelta
from random import randint, choice, randrange
from typing import Optional

from bson import json_util

from app.api.players.models import PlayerModel, PlayerStats

vk_ids = [_ for _ in range(32135496, 33136496)]
chat_ids = [_ for _ in range(1, 50)]
names = [
    ("Август", "m"),
    ("Авдей", "m"),
    ("Аверкий", "m"),
    ("Аверьян", "m"),
    ("Авксентий", "m"),
    ("Автоном", "m"),
    ("Агап", "m"),
    ("Агафон", "m"),
    ("Аггей", "m"),
    ("Адам", "m"),
    ("Адриан", "m"),
    ("Азарий", "m"),
    ("Аким", "m"),
    ("Александр", "m"),
    ("Алексей", "m"),
    ("Амвросий", "m"),
    ("Амос", "m"),
    ("Ананий", "m"),
    ("Анатолий", "m"),
    ("Андрей", "m"),
    ("Андрон", "m"),
    ("Андроник", "m"),
    ("Аникей", "m"),
    ("Аникита", "m"),
    ("Анисим", "m"),
    ("Антип", "m"),
    ("Антонин", "m"),
    ("Аполлинарий", "m"),
    ("Аполлон", "m"),
    ("Арефий", "m"),
    ("Аристарх", "m"),
    ("Аркадий", "m"),
    ("Арсений", "m"),
    ("Артемий", "m"),
    ("Артем", "m"),
    ("Архип", "m"),
    ("Аскольд", "m"),
    ("Афанасий", "m"),
    ("Афиноген", "m"),
    ("Бажен", "m"),
    ("Богдан", "m"),
    ("Болеслав", "m"),
    ("Борис", "m"),
    ("Борислав", "m"),
    ("Боян", "m"),
    ("Бронислав", "m"),
    ("Будимир", "m"),
    ("Вадим", "m"),
    ("Валентин", "m"),
    ("Валерий", "m"),
    ("Валерьян", "m"),
    ("Варлаам", "m"),
    ("Варфоломей", "m"),
    ("Василий", "m"),
    ("Вацлав", "m"),
    ("Велимир", "m"),
    ("Венедикт", "m"),
    ("Вениамин", "m"),
    ("Викентий", "m"),
    ("Виктор", "m"),
    ("Викторин", "m"),
    ("Виссарион", "m"),
    ("Виталий", "m"),
    ("Владилен", "m"),
    ("Владлен", "m"),
    ("Владимир", "m"),
    ("Владислав", "m"),
    ("Влас", "m"),
    ("Всеволод", "m"),
    ("Всемил", "m"),
    ("Всеслав", "m"),
    ("Вышеслав", "m"),
    ("Вячеслав", "m"),
    ("Гаврила", "m"),
    ("Галактион", "m"),
    ("Гедеон", "m"),
    ("Геннадий", "m"),
    ("Георгий", "m"),
    ("Герасим", "m"),
    ("Герман", "m"),
    ("Глеб", "m"),
    ("Гордей", "m"),
    ("Гостомысл", "m"),
    ("Гремислав", "m"),
    ("Григорий", "m"),
    ("Гурий", "m"),
    ("Давыд", "m"),
    ("Данила", "m"),
    ("Дементий", "m"),
    ("Демид", "m"),
    ("Демьян", "m"),
    ("Денис", "m"),
    ("Дмитрий", "m"),
    ("Добромысл", "m"),
    ("Доброслав", "m"),
    ("Дорофей", "m"),
    ("Евгений", "m"),
    ("Евграф", "m"),
    ("Евдоким", "m"),
    ("Евлампий", "m"),
    ("Евсей", "m"),
    ("Евстафий", "m"),
    ("Евстигней", "m"),
    ("Егор", "m"),
    ("Елизар", "m"),
    ("Елисей", "m"),
    ("Емельян", "m"),
    ("Епифан", "m"),
    ("Еремей", "m"),
    ("Ермил", "m"),
    ("Ермолай", "m"),
    ("Ерофей", "m"),
    ("Ефим", "m"),
    ("Ефрем", "m"),
    ("Захар", "m"),
    ("Зиновий", "m"),
    ("Зосима", "m"),
    ("Иван", "m"),
    ("Игнатий", "m"),
    ("Игорь", "m"),
    ("Измаил", "m"),
    ("Изот", "m"),
    ("Изяслав", "m"),
    ("Иларион", "m"),
    ("Илья", "m"),
    ("Иннокентий", "m"),
    ("Иосиф", "m"),
    ("Ипат", "m"),
    ("Ипатий", "m"),
    ("Ипполит", "m"),
    ("Ираклий", "m"),
    ("Исай", "m"),
    ("Исидор", "m"),
    ("Казимир", "m"),
    ("Каллистрат", "m"),
    ("Капитон", "m"),
    ("Карл", "m"),
    ("Карп", "m"),
    ("Касьян", "m"),
    ("Ким", "m"),
    ("Кир", "m"),
    ("Кирилл", "m"),
    ("Клавдий", "m"),
    ("Климент", "m"),
    ("Кондрат", "m"),
    ("Кондратий", "m"),
    ("Конон", "m"),
    ("Константин", "m"),
    ("Корнил", "m"),
    ("Кузьма", "m"),
    ("Куприян", "m"),
    ("Лавр", "m"),
    ("Лаврентий", "m"),
    ("Ладимир", "m"),
    ("Ладислав", "m"),
    ("Лазарь", "m"),
    ("Лев", "m"),
    ("Леон", "m"),
    ("Леонид", "m"),
    ("Леонтий", "m"),
    ("Лонгин", "m"),
    ("Лука", "m"),
    ("Лукьян", "m"),
    ("Лучезар", "m"),
    ("Любим", "m"),
    ("Любомир", "m"),
    ("Любосмысл", "m"),
    ("Макар", "m"),
    ("Максим", "m"),
    ("Максимильян", "m"),
    ("Мариан", "m"),
    ("Марк", "m"),
    ("Мартын", "m"),
    ("Мартьян", "m"),
    ("Матвей", "m"),
    ("Мефодий", "m"),
    ("Мечислав", "m"),
    ("Милан", "m"),
    ("Милен", "m"),
    ("Милий", "m"),
    ("Милован", "m"),
    ("Мина", "m"),
    ("Мир", "m"),
    ("Мирон", "m"),
    ("Мирослав", "m"),
    ("Митофан", "m"),
    ("Михаил", "m"),
    ("Михей", "m"),
    ("Модест", "m"),
    ("Моисей", "m"),
    ("Мокей", "m"),
    ("Мстислав", "m"),
    ("Назар", "m"),
    ("Наркис", "m"),
    ("Натан", "m"),
    ("Наум", "m"),
    ("Нестор", "m"),
    ("Никандр", "m"),
    ("Никанор", "m"),
    ("Никита", "m"),
    ("Никифор", "m"),
    ("Никодим", "m"),
    ("Николай", "m"),
    ("Никон", "m"),
    ("Нифонт", "m"),
    ("Олег", "m"),
    ("Олимпий", "m"),
    ("Онуфрий", "m"),
    ("Орест", "m"),
    ("Осип", "m"),
    ("Остап", "m"),
    ("Остромир", "m"),
    ("Павел", "m"),
    ("Панкратий", "m"),
    ("Панкрат", "m"),
    ("Пантелеймон", "m"),
    ("Панфил", "m"),
    ("Парамон", "m"),
    ("Парфен", "m"),
    ("Пахом", "m"),
    ("Петр", "m"),
    ("Пимен", "m"),
    ("Платон", "m"),
    ("Поликарп", "m"),
    ("Порфирий", "m"),
    ("Потап", "m"),
    ("Пров", "m"),
    ("Прокл", "m"),
    ("Прокофий", "m"),
    ("Прохор", "m"),
    ("Радим", "m"),
    ("Радислав", "m"),
    ("Радован", "m"),
    ("Ратибор", "m"),
    ("Ратмир", "m"),
    ("Родион", "m"),
    ("Роман", "m"),
    ("Ростислав", "m"),
    ("Рубен", "m"),
    ("Руслан", "m"),
    ("Рюрик", "m"),
    ("Савва", "m"),
    ("Савватий", "m"),
    ("Савелий", "m"),
    ("Самсон", "m"),
    ("Самуил", "m"),
    ("Светозар", "m"),
    ("Святополк", "m"),
    ("Святослав", "m"),
    ("Севастьян", "m"),
    ("Селиван", "m"),
    ("Селиверст", "m"),
    ("Семен", "m"),
    ("Серафим", "m"),
    ("Сергей", "m"),
    ("Сигизмунд", "m"),
    ("Сидор", "m"),
    ("Сила", "m"),
    ("Силантий", "m"),
    ("Сильвестр", "m"),
    ("Симон", "m"),
    ("Сократ", "m"),
    ("Соломон", "m"),
    ("Софон", "m"),
    ("Софрон", "m"),
    ("Спартак", "m"),
    ("Спиридон", "m"),
    ("Станимир", "m"),
    ("Станислав", "m"),
    ("Степан", "m"),
    ("Стоян", "m"),
    ("Тарас", "m"),
    ("Твердислав", "m"),
    ("Творимир", "m"),
    ("Терентий", "m"),
    ("Тимофей", "m"),
    ("Тимур", "m"),
    ("Тит", "m"),
    ("Тихон", "m"),
    ("Трифон", "m"),
    ("Трофим", "m"),
    ("Ульян", "m"),
    ("Устин", "m"),
    ("Фадей", "m"),
    ("Федор", "m"),
    ("Федосий", "m"),
    ("Федот", "m"),
    ("Феликс", "m"),
    ("Феоктист", "m"),
    ("Феофан", "m"),
    ("Ферапонт", "m"),
    ("Филарет", "m"),
    ("Филимон", "m"),
    ("Филипп", "m"),
    ("Фирс", "m"),
    ("Флорентин", "m"),
    ("Фока", "m"),
    ("Фома", "m"),
    ("Фортунат", "m"),
    ("Фотий", "m"),
    ("Фрол", "m"),
    ("Харитон", "m"),
    ("Харлампий", "m"),
    ("Христофор", "m"),
    ("Чеслав", "m"),
    ("Эдуард", "m"),
    ("Эммануил", "m"),
    ("Эмиль", "m"),
    ("Эраст", "m"),
    ("Эрнест", "m"),
    ("Эрнст", "m"),
    ("Ювеналий", "m"),
    ("Юлиан", "m"),
    ("Юлий", "m"),
    ("Юрий", "m"),
    ("Яков", "m"),
    ("Ян", "m"),
    ("Якуб", "m"),
    ("Януарий", "m"),
    ("Ярополк", "m"),
    ("Ярослав", "m"),
    ("Августа", "w"),
    ("Агата", "w"),
    ("Агафья", "w"),
    ("Аглая", "w"),
    ("Агнесса", "w"),
    ("Агния", "w"),
    ("Аграфена", "w"),
    ("Агриппина", "w"),
    ("Ада", "w"),
    ("Аделаида", "w"),
    ("Аза", "w"),
    ("Алевтина", "w"),
    ("Александра", "w"),
    ("Алина", "w"),
    ("Алиса", "w"),
    ("Алла", "w"),
    ("Альбина", "w"),
    ("Анастасия", "w"),
    ("Ангелина", "w"),
    ("Анисья", "w"),
    ("Анна", "w"),
    ("Антонида", "w"),
    ("Антонина", "w"),
    ("Анфиса", "w"),
    ("Аполлинария", "w"),
    ("Ариадна", "w"),
    ("Беатриса", "w"),
    ("Берта", "w"),
    ("Борислава", "w"),
    ("Бронислава", "w"),
    ("Валентина", "w"),
    ("Валерия", "w"),
    ("Ванда", "w"),
    ("Варвара", "w"),
    ("Василиса", "w"),
    ("Васса", "w"),
    ("Вера", "w"),
    ("Вероника", "w"),
    ("Викторина", "w"),
    ("Виктория", "w"),
    ("Виргиния", "w"),
    ("Влада", "w"),
    ("Владилена", "w"),
    ("Владлена", "w"),
    ("Владислава", "w"),
    ("Власта", "w"),
    ("Всеслава", "w"),
    ("Галина", "w"),
    ("Галя", "w"),
    ("Ганна", "w"),
    ("Генриетта", "w"),
    ("Глафира", "w"),
    ("Горислава", "w"),
    ("Дарья", "w"),
    ("Диана", "w"),
    ("Дина", "w"),
    ("Доминика", "w"),
    ("Домна", "w"),
    ("Ева", "w"),
    ("Евгеиня", "w"),
    ("Евдокия", "w"),
    ("Евлампия", "w"),
    ("Екатерина", "w"),
    ("Елена", "w"),
    ("Елизавета", "w"),
    ("Ефросинья", "w"),
    ("Жанна", "w"),
    ("Зинаида", "w"),
    ("Злата", "w"),
    ("Зоя", "w"),
    ("Изабелла", "w"),
    ("Изольда", "w"),
    ("Инга", "w"),
    ("Инесса", "w"),
    ("Инна", "w"),
    ("Ираида", "w"),
    ("Ирина", "w"),
    ("Ия", "w"),
    ("Казимира", "w"),
    ("Калерия", "w"),
    ("Капитолина", "w"),
    ("Каролина", "w"),
    ("Кира", "w"),
    ("Клавдия", "w"),
    ("Клара", "w"),
    ("Кларисса", "w"),
    ("Клементина", "w"),
    ("Клеопатра", "w"),
    ("Конкордия", "w"),
    ("Ксения", "w"),
    ("Лада", "w"),
    ("Лариса", "w"),
    ("Леокадия", "w"),
    ("Лиана", "w"),
    ("Лидия", "w"),
    ("Лилиана", "w"),
    ("Клеопатра", "w"),
    ("Конкордия", "w"),
    ("Ксения", "w"),
    ("Лада", "w"),
    ("Лариса", "w"),
    ("Леокадия", "w"),
    ("Лиана", "w"),
    ("Лидия", "w"),
    ("Лилиана", "w"),
    ("Лилия", "w"),
    ("Лия", "w"),
    ("Луиза", "w"),
    ("Лукерья", "w"),
    ("Любава", "w"),
    ("Любовь", "w"),
    ("Любомила", "w"),
    ("Любомира", "w"),
    ("Людмила", "w"),
    ("Майя", "w"),
    ("Мальвина", "w"),
    ("Маргарита", "w"),
    ("Марианна", "w"),
    ("Мариетта", "w"),
    ("Марина", "w"),
    ("Мария", "w"),
    ("Марта", "w"),
    ("Марфа", "w"),
    ("Меланья", "w"),
    ("Мелитриса", "w"),
    ("Милана", "w"),
    ("Милена", "w"),
    ("Милица", "w"),
    ("Мира", "w"),
    ("Мирослава", "w"),
    ("Млада", "w"),
    ("Мстислава", "w"),
    ("Муза", "w"),
    ("Надежда", "w"),
    ("Наталья", "w"),
    ("Наталия", "w"),
    ("Неонила", "w"),
    ("Ника", "w"),
    ("Нина", "w"),
    ("Нинель", "w"),
    ("Нона", "w"),
    ("Оксана", "w"),
    ("Октябрина", "w"),
    ("Олимпиада", "w"),
    ("Ольга", "w"),
    ("Пелагея", "w"),
    ("Поликсена", "w"),
    ("Полина", "w"),
    ("Прасковья", "w"),
    ("Пульхерия", "w"),
    ("Рада", "w"),
    ("Раиса", "w"),
    ("Регина", "w"),
    ("Рената", "w"),
    ("Римма", "w"),
    ("Рогнеда", "w"),
    ("Роза", "w"),
    ("Розалия", "w"),
    ("Розина", "w"),
    ("Ростислава", "w"),
    ("Руфина", "w"),
    ("Светлана", "w"),
    ("Серафима", "w"),
    ("Сильва", "w"),
    ("Сильвия", "w"),
    ("Саломея", "w"),
    ("Софья", "w"),
    ("Станислава", "w"),
    ("Стела", "w"),
    ("Степанида", "w"),
    ("Сусанна", "w"),
    ("Таисия", "w"),
    ("Тамара", "w"),
    ("Татьяна", "w"),
    ("Ульяна", "w"),
    ("Фаина", "w"),
    ("Федосья", "w"),
    ("Фелицата", "w"),
    ("Флора", "w"),
    ("Флорентина", "w"),
    ("Фатина", "w"),
    ("Харитина", "w"),
    ("Христина", "w"),
    ("Эвелина", "w"),
    ("Элеонора", "w"),
    ("Эльвира", "w"),
    ("Эмилия", "w"),
    ("Эмма", "w"),
    ("Юлия", "w"),
    ("Ядвига", "w"),
    ("Ярослава", "w"),
]

last_name_ = [
    "Смирнов",
    "Иванов",
    "Кузнецов",
    "Соколов",
    "Попов",
    "Лебедев",
    "Козлов",
    "Новиков",
    "Морозов",
    "Петров",
    "Волков",
    "Соловьёв",
    "Васильев",
    "Зайцев",
    "Павлов",
    "Семёнов",
    "Голубев",
    "Виноградов",
    "Богданов",
    "Воробьёв",
    "Фёдоров",
    "Михайлов",
    "Беляев",
    "Тарасов",
    "Белов",
    "Комаров",
    "Орлов",
    "Киселёв",
    "Макаров",
    "Андреев",
    "Ковалёв",
    "Ильин",
    "Гусев",
    "Титов",
    "Кузьмин",
    "Кудрявцев",
    "Баранов",
    "Куликов",
    "Алексеев",
    "Степанов",
    "Яковлев",
    "Сорокин",
    "Сергеев",
    "Романов",
    "Захаров",
    "Борисов",
    "Королёв",
    "Герасимов",
    "Пономарёв",
    "Григорьев",
    "Лазарев",
    "Медведев",
    "Ершов",
    "Никитин",
    "Соболев",
    "Рябов",
    "Поляков",
    "Цветков",
    "Данилов",
    "Жуков",
    "Фролов",
    "Журавлёв",
    "Николаев",
    "Крылов",
    "Максимов",
    "Сидоров",
    "Осипов",
    "Белоусов",
    "Федотов",
    "Дорофеев",
    "Егоров",
    "Матвеев",
    "Бобров",
    "Дмитриев",
    "Калинин",
    "Анисимов",
    "Петухов",
    "Антонов",
    "Тимофеев",
    "Никифоров",
    "Веселов",
    "Филиппов",
    "Марков",
    "Большаков",
    "Суханов",
    "Миронов",
    "Ширяев",
    "Александров",
    "Коновалов",
    "Шестаков",
    "Казаков",
    "Ефимов",
    "Денисов",
    "Громов",
    "Фомин",
    "Давыдов",
    "Мельников",
    "Щербаков",
    "Блинов",
    "Колесников",
    "Карпов",
    "Афанасьев",
    "Власов",
    "Маслов",
    "Исаков",
    "Тихонов",
    "Аксёнов",
    "Гаврилов",
    "Родионов",
    "Котов",
    "Горбунов",
    "Кудряшов",
    "Быков",
    "Зуев",
    "Третьяков",
    "Савельев",
    "Панов",
    "Рыбаков",
    "Суворов",
    "Абрамов",
    "Воронов",
    "Мухин",
    "Архипов",
    "Трофимов",
    "Мартынов",
    "Емельянов",
    "Горшков",
    "Чернов",
    "Овчинников",
    "Селезнёв",
    "Панфилов",
    "Копылов",
    "Михеев",
    "Галкин",
    "Назаров",
    "Лобанов",
    "Лукин",
    "Беляков",
    "Потапов",
    "Некрасов",
    "Хохлов",
    "Жданов",
    "Наумов",
    "Шилов",
    "Воронцов",
    "Ермаков",
    "Дроздов",
    "Игнатьев",
    "Савин",
    "Логинов",
    "Сафонов",
    "Капустин",
    "Кириллов",
    "Моисеев",
    "Елисеев",
    "Кошелев",
    "Костин",
    "Горбачёв",
    "Орехов",
    "Ефремов",
    "Исаев",
    "Евдокимов",
    "Калашников",
    "Кабанов",
    "Носков",
    "Юдин",
    "Кулагин",
    "Лапин",
    "Прохоров",
    "Нестеров",
    "Харитонов",
    "Агафонов",
    "Муравьёв",
    "Ларионов",
    "Федосеев",
    "Зимин",
    "Пахомов",
    "Шубин",
    "Игнатов",
    "Филатов",
    "Крюков",
    "Рогов",
    "Кулаков",
    "Терентьев",
    "Молчанов",
    "Владимиров",
    "Артемьев",
    "Гурьев",
    "Зиновьев",
    "Гришин",
    "Кононов",
    "Дементьев",
    "Ситников",
    "Симонов",
    "Мишин",
    "Фадеев",
    "Комиссаров",
    "Мамонтов",
    "Носов",
    "Гуляев",
    "Шаров",
    "Устинов",
    "Вишняков",
    "Евсеев",
    "Лаврентьев",
    "Брагин",
    "Константинов",
    "Корнилов",
    "Авдеев",
    "Зыков",
    "Бирюков",
    "Шарапов",
    "Никонов",
    "Щукин",
    "Дьячков",
    "Одинцов",
    "Сазонов",
    "Якушев",
    "Красильников",
    "Гордеев",
    "Самойлов",
    "Князев",
    "Беспалов",
    "Уваров",
    "Шашков",
    "Бобылёв",
    "Доронин",
    "Белозёров",
    "Рожков",
    "Самсонов",
    "Мясников",
    "Лихачёв",
    "Буров",
    "Сысоев",
    "Фомичёв",
    "Русаков",
    "Стрелков",
    "Гущин",
    "Тетерин",
    "Колобов",
    "Субботин",
    "Фокин",
    "Блохин",
    "Селиверстов",
    "Пестов",
    "Кондратьев",
    "Силин",
    "Меркушев",
    "Лыткин",
    "Туров",
]


def generate_stats() -> PlayerStats:
    max_cash = randint(100, 10000)
    number_of_games = randint(10, 100)
    number_of_wins = randint(1, number_of_games)
    defeatsndraws = number_of_games - number_of_wins

    number_of_defeats = randint(0, defeatsndraws)
    max_bet = randint(100, 10000)
    average_bet = randint(1, 500)
    max_win = randint(0, max_cash)

    return PlayerStats(
        max_cash=max_cash,
        number_of_games=number_of_games,
        number_of_wins=number_of_wins,
        number_of_defeats=number_of_defeats,
        max_bet=max_bet,
        max_win=max_win,
        average_bet=average_bet,
    )


def _random_date(
    start_date: Optional[datetime] = None, end_date: Optional[datetime] = None
):
    if not start_date:
        start_date = datetime(2021, 9, 1)

    if not end_date:
        end_date = datetime(2021, 9, 28)

    if end_date == start_date:
        end_date = datetime(2021, 9, 29)

    time_between_dates = end_date - start_date
    days_between_dates = time_between_dates.days + 1

    return start_date + timedelta(days=randint(0, days_between_dates))


def generate_player() -> PlayerModel:
    stat = generate_stats()
    name = choice(names)

    vk_id = vk_ids.pop(randint(0, len(vk_ids)))
    chat_id = 200000000 + choice(chat_ids)
    cash = randint(1, int(stat.max_cash))
    first_name = name[0]
    last_name = choice(last_name_) + ("а" if first_name[1] == "w" else "")
    stats = stat
    registered_at = _random_date()
    last_bonus_date = _random_date(start_date=registered_at)

    return PlayerModel(
        vk_id=vk_id,
        chat_id=chat_id,
        cash=cash,
        first_name=first_name,
        last_name=last_name,
        stats=stats,
        registered_at=registered_at,
        last_bonus_date=last_bonus_date,
    )


def generate(qty: int) -> list[dict]:
    return [generate_player().to_dict() for _ in range(qty)]


def write(filename: str, data: list[dict]):
    with open(f"{filename}.json", "w") as f:
        for p in data:
            f.write(json.dumps(p, default=json_util.default, ensure_ascii=False))
            f.write("\n")


def main(qty: int):
    data = generate(qty)
    write("players", data)


if __name__ == "__main__":
    main(10000)
